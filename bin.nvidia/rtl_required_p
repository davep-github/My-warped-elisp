#!/bin/sh

source script-x
set -u
progname="$(basename $0)"
source eexec
eexec_program=$(EExec_parse "$@")
for op in $eexec_program
do
  $op
  shift
done
unset eexec_program

: ${RTL_PRESENT_INDICATOR_FILE="DP_RTL_SB"}
: ${build_dir=}
: ${make_it_p=}

for i in "$@"
do
  case "$1" in
      --name) echo "${RTL_PRESENT_INDICATOR_FILE}"; exit 0;;
      -c|-t|--touch|--creat|--create) make_it_p=t;;
      --build-dir) shift; build_dir="${1}";;
      --here) build_dir=$PWD;;
      *) break;
  esac
  shift
done

sb=$(dp-sb-root -s)
#echo_id sb
#echo_id RTL_SANDBOXES
vsetp "${RTL_SANDBOXES-}" && {
    case "${RTL_SANDBOXES}" in
        :$sb:) exit 0;;
    esac
}

if vsetp "${build_dir}"
then
    cd "${build_dir}"
else
    mecd ap
fi

vtruep "${make_it_p}" && {
    touch "${RTL_PRESENT_INDICATOR_FILE}"
    exit 0
}

[ -e "${RTL_PRESENT_INDICATOR_FILE}" ] && exit 0

exit 1   
