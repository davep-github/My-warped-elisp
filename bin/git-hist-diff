#!/bin/sh

source script-x
set -u

: ${commit:=HEAD}

git_hist_diff_file()
{
    local commit="$1"
    local file="$2"
    git rev-list "$commit" -- "$file" | \
  while read
  do
      git diff $REPLY -- "$file"
  done
}

[ $# = 0 ] && {
    echo 1>&2 "usage: commit=<COMMIT> $(basename $0) files...
For all files, diff them against all specs in rev-list COMMIT"
}

for f in "$@"
do
  git_hist_diff_file "$commit" "$f"
done

