<!DOCTYPE html> 
<html>
<head>
  <link rel="stylesheet" type="text/css" href="css/jquery.autocomplete.css" />
  <link rel="stylesheet" type="text/css" href="css/evernote.css" />
  
  <!-- 3rd party libs -->
  <script type="text/javascript" src="libs/jquery/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.scrollTo-1.4.2-min.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.autocomplete.pack.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.validate.pack.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.validate.methods.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.observeform.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery-ui-1.8.fx.min.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.ascrollable.js"></script>
  <script type="text/javascript" src="libs/jquery/jquery.tabdrawer.js"></script>
  <script type="text/javascript" src="libs/json2.js"></script>
  <script type="text/javascript" src="libs/simpledateformat.js"></script>
  
  <script type="text/javascript" src="libs/evernote-cr/evernoteChromeExtension.js"></script>

  <script type="text/javascript">
      var popup = null;
      var LOG = null;
			$(document).ready(function popupHtml() {
        LOG = Evernote.chromeExtension.getLogger();
        window.onerror = function(errorMsg, url, lineNumber) {
          LOG.exception("\n" + url + ":" + lineNumber + ": " + errorMsg + "\n");
        }
        Evernote.Logger.setInstance(Evernote.chromeExtension.logger);
        popup = new Evernote.ChromePopup();
        Evernote.ViewManager.getInstance().wait(chrome.i18n.getMessage("loading"));
        // startup with setTimeout for better UX
        setTimeout(function(){
          popup.remoteSyncState(function(response) {
            popup.startUp();
          }, function(xhr, textStatus, response) {
            popup.popupStatus = Evernote.ChromePopup.POPUP_STATUS_CODES.STARTED;
            if (response instanceof Evernote.EDAMResponse && response.hasAuthenticationError()) {
              LOG.info("Present login screen due to authentication error on initial sync");
              popup.viewManager.switchView("loginView");
            }
            /* pasha: commented out for the next release; uncommenting would allow the popup to operate in offline mode
            } else if (Evernote.context.userKnown) {
              LOG.debug("Starting up despite an error with initial syncState retreival, because the user is known");
              popup.startUp();
            } else {
              LOG.debug("Unknown and unhadled error during popup startup.");
              popup.viewManager.showError(chrome.i18n.getMessage("UnknownError"));
            }
            */
          });
        }, 300);
			});
		</script>
</head>
<body class="popup">
  <div id="spinner" class="spinner banner">
    <div id="spinnerMessage"></div>
  </div>
  <div id="globalErrorMessage" class="globalErrorMessage banner">
  </div>
  <div id="globalMessage" class="globalMessage banner">
  </div>
  <div id="header" style="display: none;">
    <div id="headerLogo">
      <a href="javascript:popup.goHome();" tabindex="-1"><img src="images/logo-30.gif"/></a>
    </div>
    <div id="headerUser" class="headerLinks">
      <a id="headerSignout" message="signout" href="javascript:popup.logout();" tabindex="100"></a> (<span id="headerUsername"></span>)
    </div>
    <div id="headerNoUser" class="headerLinks">
    </div>
  </div>
  <div id="loginView" class="view">
    <h2 message="loginToEvernote"></h2>
    <form name="loginForm" action="#">
      <table class="formTable">
        <tr>
          <td><label for="username" message="loginForm_username"></label></td> 
          <td><input type="text" name="username" maxlength="64" style="text-transform: lowercase" tabindex="1"/> </td>
        </tr>
        <tr>
          <td><label for="password" message="loginForm_password"></label></td> 
          <td><input type="password" name="password" maxlength="64" tabindex="2"/> </td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td><input type="checkbox" id="useSearchHelper" name="useSearchHelper" tabindex="4"/>&nbsp;<label for="useSearchHelper" message="loginForm_searchHelper"></label></td>
        </tr>
        <tr>
          <td style="min-width: 100px;">&nbsp;</td>
          <td>
            <input type="checkbox" name="rememberMe" tabindex="3"/>&nbsp;<label for="rememberMe" message="loginForm_rememberMe"></label>
            <div id="login_storedCredentialsShortDescription" class="loginDescription friendlyWarning" style="padding-left: 23px;">
              <span message="options_storedCredentialsShortDescription"></span>
              <a onclick="popup.viewManager.switchElements($('#login_storedCredentialsShortDescription'), $('#login_storedCredentialsDescription'))" message="more"></a>
            </div>
            <div id="login_storedCredentialsDescription" class="loginDescription friendlyWarning" style="padding-left: 23px; display: none;" message="options_storedCredentialsDescription"></div>
          </td>
        </tr>
        <tr class="actionControlRow">
          <td>&nbsp;</td>
          <td>
            <input type="submit" name="login" message="loginForm_login" style="margin-bottom: 8px;" tabindex="5"/><br/>
            <a id="headerRegister" message="header_register" href="javascript:popup.goRegister();" tabindex="6"></a>
          </td>
        </tr>
      </table>
    </form>
  </div>
  <div id="fileView" class="view viewWithDrawer">
    <h2 message="contentClipped"></h2><br/>
    <form name="fileForm" action="#">
      <span class="description" message="fileForm_sourceURL"></span>&nbsp;<span class="description" name="url"></span>
      <table class="neatFormTable" cellpadding="0" cellspacing="0">
        <tr class="firstRow separator"><td>
          <label for="title" message="fileForm_title"></label> 
        </td><td colspan="2">
          <input type="text" name="title" maxlength="255" tabindex="1"/>
        </td></tr>
      
        <tr class="separator"><td>
          <label for="notebookGuid" message="fileForm_notebook"></label> 
        </td><td>
          <select class="notebookSelect" name="notebookGuid" tabindex="2"></select><br />
        </td><td rowspan="3" class="noteThumbnail">
          <a href="javascript:popup.openNoteWindow(popup.fileNoteForm.noteUrl)" tabindex="-1"><img name="thumbnailUrl" src=""/></a><br/>
          <div class="paddedVertical"><a href="javascript:popup.openNoteWindow(popup.fileNoteForm.noteUrl);" class="noteLink" message="fileForm_viewInEvernote" tabindex="5"></a></div>
          <input type="hidden" name="noteUrl"/>
        </td></tr>
        
        <tr><td>
          <label for="tagNames" message="fileForm_tagNames"></label> 
        </td><td>
          <input type="text" name="tagNames" maxlength="10100" tabindex="3"/><br />
        </td></tr>
      
        <tr><td>
          <label for="comment" message="fileForm_comment"></label> 
        </td><td>
          <textarea name="comment" rows="6" tabindex="4"></textarea><br/>
        </td></tr>
        
        <tr><td colspan="2">
          <label for="mailTo" message="quickNote_mailTo" class="toggleLabel"></label>
          <div id='fileNote_mailTo' style="display: none;">
            <div class='fieldDescription' message="quickNote_mailToDescription" messagedata="Evernote.Constants.Limits.EDAM_USER_RECENT_MAILED_ADDRESSES_MAX"></div>
            <input type="text" name="mailTo"/>
          </div>
        </td></tr>
        
        <tr class="actionControlRow lastRow separator"><td colspan="3">
          <input type="submit" name="file" message="fileForm_done" tabindex="6"/>&nbsp;
          <input type="button" name="cancel" message="fileForm_delete" tabindex="7" onClick="javascript:Evernote.ViewManager.getInstance().clearFormArtifacts($(this)); popup.submitDeleteForm(); return false;"/>
        </td></tr>      
      </table>
      <input type="hidden" name="guid"/>
    </form>
  </div>
  <div id="quickNoteView" class="view viewWithDrawer">
    <img class="needsSyncIndicator" src="images/needsSync.png"/><h2 message="quickNote"></h2>&nbsp;<span class="description" message="quickNoteDescription"></span><span class="description autoSaved" message="quickNoteAutoSavedDescription"></span>
    <form name="quickNoteForm" action="#">
      <table class="compactFormTable">
        <tr class="firstRow separator"><td colspan="2">        
          <label for="title" message="quickNote_title"></label>
          <input type="text" name="title" maxlength="255" tabindex="1"/>
        </td></tr>
      
        <tr><td width="240">
          <label for="tagNames" message="quickNote_tagNames"></label> 
          <input type="text" name="tagNames" maxlength="10100" tabindex="2"/>
        </td><td>
          <label for="notebookGuid" message="quickNote_notebook"></label> 
          <select class="notebookSelect" name="notebookGuid" tabindex="3"></select> 
        </td></tr>
        
        <tr><td colspan="2">
          <label for="comment" message="quickNote_comment"></label> 
          <textarea name="comment" rows="8" tabindex="4"></textarea>
        </td></tr>
        
        <tr><td colspan="2">
          <label for="mailTo" message="quickNote_mailTo" class="toggleLabel"></label>
          <div id='quickNote_mailTo' style="display: none;">
            <div class='fieldDescription' message="quickNote_mailToDescription" messagedata="Evernote.Constants.Limits.EDAM_USER_RECENT_MAILED_ADDRESSES_MAX"></div>
            <input type="text" name="mailTo"/>
          </div>
        </td></tr>
      
        <tr><td colspan="2">
          <input type="checkbox" name="saveUrl" tabindex="6"/> 
          <label for="saveUrl" message="quickNote_saveUrl"></label>&nbsp;
          <input type="checkbox" name="fullPage" tabindex="7"/> 
          <label for="fullPage" message="quickNote_fullPage"></label><br/>
        </td></tr>

        <tr class="actionControlRow lastRow separator"><td colspan="2">
          <input type="submit" name="quickNote" message="quickNote_submit" tabindex="8"/>&nbsp;
          <input type="button" name="cancel" message="quickNote_cancel" onClick="popup.cancelQuickNoteForm();" tabindex="9"/>&nbsp;
          <span id="quickNoteAutoSaveIndicator" class="autoSaveIndicator" style="display: none;" message="autoSaving"></span>
        </td></tr>      
      </table>
      <textarea name="content" style="display: none;"></textarea>
      <input type="hidden" name="url" />
    </form>
  </div>
  <div id="drawers">
    <!-- search drawer -->
    <div id="searchDrawer" style="display: none;">
      <div class="drawerHandle closedDrawer" id="notesSearchHandle">
        <div class="drawerHandleTitle" id="notesSearchTitle" message="notes_title"></div>
      </div>
      <div id="notesSearchView" class="drawer closedDrawer">
        <div id="notesSearchContainer" class="drawerContent notelistSearchContainer">
          <form name="notesSearchForm" class="drawerComponent notelistSearchForm" action="#" onSubmit="popup.submitNotesSearchForm(); return false;">
            <table id="notesSearchQueryTable" class="notelistSearchTable">
              <tbody>
              <tr>
                <td>
                  <input type="text" id="notesSearchQuery" class="notelistSearchQuery" name="notesSearchQuery"/>
                </td><td>
                  <input type="submit" class="notelistSearchSubmit" value="search" message="notesSearch_submit"/>
                </td>
              </tr>
              </tbody>
            </table>
          </form>
          <div id="notesList" class="scrollable vertical drawerComponent" style="position: relative">
            <div id="notesListItems" class='items' style="position: absolute; display: none;"></div>
            <div id="notesListLoadingContainer" style="display: none;">
              <div id="notesListLoadingIndicator">
                <img src='images/spinner.gif'/>
                <div message="notesList_loading"></div>
              </div>
            </div>
            <div id="notesListEmptyContainer" style="display: none;">
              <div id="notesListEmptyIndicator">
                <div message="noteList_nothingFound"></div>
                <small message="noteList_modifySearch"></small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- contextual drawer -->
    <div id="contextDrawer" style="display: none;">
      <div class="drawerHandle closedDrawer" id="notesContextHandle">
        <div class="drawerHandleTitle" id="notesContextTitle" message="notes_title"></div>
      </div>
      <div id="notesContextView" class="drawer closedDrawer">
        <div id="notesContextContainer" class="drawerContent notelistSearchContainer">
          <div id="notesContextListTitle" class="drawerComponent"></div>
          <div id="notesContextList" class="scrollable vertical drawerComponent" style="position: relative">
            <div id="notesContextListItems" class='items' style="position: absolute; display: none;"></div>
            <div id="notesContextListLoadingContainer" style="display: none;">
              <div id="notesContextListLoadingIndicator">
                <img src='images/spinner.gif'/>
                <div message="notesList_loading"></div>
              </div>
            </div>
            <div id="notesContextListEmptyContainer" style="display: none;">
              <div id="notesContextListEmptyIndicator">
                <div message="noteList_nothingFound"></div>
                <small message="noteList_modifySearch"></small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>