#compdef _dog dog
#autoload
# -*- mode: sh; -*-


# Imagine you have a program with an interface like the following

# dog -h | --help
# dog quietly [--silent] <message>
# dog loudly [--repeat=<number>] <message>

# This imaginary program has two command quietly and loudly that each have
# distinct arguments you can pass to them – ideally we’d like the completion
# script to complete -h, --help, quietly, and loudly when no commands are
# supplied, and once either quietly or loudly has been entered it should give
# context specific completions for those.

# The following zsh script provides completions for the program as
# described. In the rest of the post I’ll give an explanation of the general
# outline of the script and dive into some of the more interesting parts.

# see [/home/davep/DOTrc/zsh/completions/]simple-example.zsh
function _dog {
    local line

    _arguments -C \
        "-h[Show help information]" \
        "--h[Show help information]" \
	"--N[new arg]" \
        "1: :(quietly loudly)" \
        "*::arg:->args"

    case $line[1] in
        loudly)
            _dog_loudly
        ;;
        quietly)
            _dog_quietly
        ;;
    esac
}

function _dog_quietly {
    _arguments \
        "--silent[Dont output anything]"
}

function _dog_loudly {
    _arguments \
        "--repeat=[Repat the <message> any number of times]"
}


